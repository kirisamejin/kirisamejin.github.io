---
title: è«æ¯”ä¹Œæ–¯
teaser:
category:
tags: [mobius inversion]
---

----------------------------------------


æ²ˆé˜³ç½‘ç»œèµ›çš„ä¸¤é“
G
ç”¨ [(m,i)==1] å’Œ 
$$\sum_{d\mid (m,i)}\mu(d)$$ 
ç­‰ä»·çš„æ€§è´¨
ç„¶åäº¤æ¢ä¸€ä¸‹æ¬¡åº
```cpp
#include<bits/stdc++.h>

using namespace std;
typedef long long ll;
int n,m,inv6;
const int mod = 1e9+7;
vector<int> fac;
inline int factorize(int m) {
    for(int i=2;i*i<=m;++i) {
        if(m%i==0) {
            fac.push_back( i );
            while(m%i==0) m/=i;
        }
    }
    if(m!=1) fac.push_back( m );
    return fac.size();
}
inline int get(ll i,ll d) {
    ll res = 0;
    res = i*(i+1)%mod*(2*i+1)%mod*inv6%mod*d%mod*d%mod;
    res = (res + (i*(i+1)/2)%mod*d%mod)%mod;
    return res;
}
ll qpow(ll a,ll b) {ll res=1;for(;b;(b&1)?res=(res*a)%mod:0,a=(a*a)%mod,b>>=1); return res;}
int main() {
    inv6 = qpow(6,mod-2);
    while(~scanf("%d%d",&n,&m)) {
        fac.clear();
        int len = factorize(m);
        int ma = (1<<len) ;
        int ans = 0;
        for(int bt=0;bt<ma;++bt) {
            ll d = 1, miu = 1;
            for(int i=0;i<len;++i) {
                if( bt&(1<<i) ) d *= fac[i], miu*=-1;
            }
            ll i=n/d;
            ans = ( (ans + miu*get(i,d))%mod + mod ) % mod;
        }
        printf("%lld\n",ans);
    }
    return 0;
}
```
C
æŠŠå¤–é¢çš„äº¤æ¢æ¬¡åºå¾—åˆ°(n-i+1)f(i)ï¼Œ
ç„¶åç”¨ä¸Š

$$
\lambda(n)=\sum_{d^2\mid n}\mu(n/d)\quad\text{and}\quad\mu^2(n)=\sum_{d^2\mid n}\mu(d)
$$

[click this for proof](https://math.stackexchange.com/questions/1053000/prove-lambdan-sum-d2n-mun-d2-and-mu2n-sum-d2n-mud)
å³è¾¹è¿™ä¸ªå…¬å¼ å’ŒCé¢˜ä¸€æ ·å†äº¤æ¢ä¸€ä¸‹å°±æ¼”å‡ºæ¥äº†

å¯¹ä¸èµ·æˆ‘å°±æ˜¯ä¸ªå‚»é€¼ï¼Œå†™ä¸ªç­›æ³•å†™äº†ä¸‰å¤„é”™è¯¯æˆ‘ä¹Ÿæ˜¯ä½©æœæˆ‘è‡ªå·±ã€‚
```cpp
#include<bits/stdc++.h>

using namespace std;
typedef long long ll;
__int128 n,p;
inline ll cal2(__int128 n1) {
    return n1*(n1+1)%(6*p)*(2*n1+1)%(6*p)/6;
}
inline ll cal3(__int128 n1) {
    __int128 tmp = n1*(n1+1)%(2*p)/2;
    return tmp*tmp%p;
}
const int N = 1e5;
int v[N+100],pr[N+100],tot,mu[N+100];
int si() {
    mu[1]=1;
    for(int i=2;i<=N;++i) {
        if(!v[i]) pr[++tot]=i, mu[i]=-1;
        //else {
            for(int j=1;j<=tot&&i*pr[j]<=N;++j) {
                v[i*pr[j]] = 1;
                if(i%pr[j]==0) {
                    mu[i*pr[j]] = 0;
                    break;
                } else mu[i*pr[j]] = mu[i] * mu[pr[j]];
            }
        //}
    }
}
int main() {
    si(); 
    while(~scanf("%lld%lld",&n,&p)) {
        __int128 ans = 0, t, t2;
        for(ll i=1;i*i<=n;++i) {
            t=i*i;
            t2=t*t%p;
            if(mu[i]) {
                ans=(ans+mu[i]*(t2*(n+1)%p)*cal2(n/(ll)t)%p)%p;
                ans=(ans-mu[i]*((t2*t)%p)*cal3(n/(ll)t)%p)%p;
            }
        }
        ans = (ans+p)%p;
        printf("%lld\n", (ll)ans );
    }
    return 0;
}
```



å…³äºæœæ•™ç­›
[æˆ‘çœ‹çš„è¿™ç¯‡çš„è¯æ˜](https://www.cnblogs.com/peng-ym/p/9446555.html)
- å¦‚ä½•å–åˆ°æ‰€æœ‰çš„$\lfloor \frac nk \rfloor$?
```cpp
for(int l=1;l<=n;l=r+1) {
    r = n/l/l;
    len = (n/l/l - l + 1);
}
```
(è¿™ä¸ªç°åœ¨æˆ‘åªèƒ½æ¨¡æ‹Ÿä»£ç ç†è§£ä¸€ä¸‹ä¸çŸ¥é“æ€ä¹ˆä¸¥è°¨æ˜“æ‡‚çš„è¯æ˜)
æ„Ÿè§‰ä¸Šå°±æ˜¯æ¯”å¦‚è¯´ä»d=1å¼€å§‹ï¼Œå¾—åˆ°ä¸€ä¸ªn/d=kï¼Œç„¶ån/kå¾—åˆ°çš„å€¼è‚¯å®šæ˜¯n/x=kçš„æœ€å¤§çš„xï¼ˆæ ¹æ®é™¤æ³•ç„¶åå‘ä¸‹å–æ•´çš„è¿ç®—è§„åˆ™ï¼‰ï¼Œé‚£ä¹ˆè¿™ä¸ªæœ€å¤§çš„x+1å°±æ˜¯ä¸‹ä¸€æ¬¡çš„å·¦ç«¯ç‚¹ã€‚

 1. ä¸€äº›æ ‡è®°ï¼š
 $$\iota(n)=\left\{
\begin{aligned}
1, n=1 \\
0, n>1 \\
\end{aligned}
\right.
 $$
 the sum of divisors function $\sigma$
 $$\sigma(n)=\sum_{d \mid n}d$$ 
 the number of divisors function $\tau$
 $$\tau(n)=\sum_{d \mid n}1$$
 **completely multiplicative function**:
 $$\nu(n)=1$$
 $$id(n)=n$$
 $$id^k(n)=n^k$$
 
 2. æœ‰*Dirichlet product*
 $\iota = \mu*\nu$
 $id = \phi*\nu$ 
 
-  è®¡ç®—ç§¯æ€§å‡½æ•°f(i)çš„å’Œ
- æ±‚$\sum_{i=1}^n f(i)$
- ä»¤$h = f * g $

$$\sum_{i=1}^{n}h(i)=g(1)\cdot S(n)+\sum_{d=2}^{n}g(d)\cdot S(\lfloor\frac{n}{d}\rfloor)$$
$$g(1)\cdot S(n)=\sum_{i=1}^{n}h(i)-\sum_{d=2}^{n}g(d)\cdot S(\lfloor\frac{n}{d}\rfloor)$$
$\sum_{d=2}^{n}g(d)\cdot S(\lfloor\frac{n}{d}\rfloor)$è¿™ä¸ªä¸œè¥¿å¯ä»¥åˆ†å—æ±‚
å¤æ‚åº¦ï¼š
$O(n^\frac 23)$
è¯æ˜ï¼š
åªè¦è®¡ç®—å‡ºO($\sqrt n$)ä¸ª$S(\lfloor \frac ni \rfloor)$çš„å€¼ï¼Œå°±å¯ä»¥æ±‚å‡ºS(n)
$T(n) = O(\sqrt n)+\sum_{i=1}^{\sqrt n}T(i) + T(\frac ni)$
$T(n)=\sum_{i=1}^{\sqrt n}O(\sqrt {\frac ni})=O(n^{\frac 34})$(æ¢æˆè¿ç»­ç§¯ä¸ªåˆ†)
ï¼ˆtlsåšå®¢è¯´å› ä¸ºæ›´æ·±å±‚å¤æ‚åº¦æ˜¯é«˜é˜¶å°é‡æ‰€ä»¥åªå±•å¼€ä¸€å±‚ï¼‰

å¦‚æœé¢„å¤„ç†å‰kä¸ªphiä¸”k>=$\sqrt n$é‚£ä¹ˆè¿™ä¸€å—å¯ä»¥ç›´æ¥æ±‚ ï¼Œå‰©ä¸‹çš„å°±åªæœ‰
 ç„¶åå–k=n^(2/3)
$T(n)=\sum_{i=1}^{\frac nk}O(\sqrt {\frac n{\frac ki}})=O(n^{\frac 23})$


å¾å·ç½‘ç»œèµ›D

æ±‚$\sum\limits_{i=1}^m \mu(i*n) ï¼ˆ1 \leq n \leq 1e12 \text{ and } 1\leq m \leq 2e9 ï¼‰$
ä»¤$f(m,n) = \sum\limits_{i=1}^m \mu(i*n) $
æ˜¾ç„¶
$$ \mu(i\cdot n)=\left\{
\begin{aligned}
 0, (i,n)>1 \\
\mu(i)\cdot \mu(n), (i,n)=1 \\
\end{aligned}
\right.
$$
åˆ™
$\Rightarrow \mu(n)\cdot \sum\limits_{(i,n)=1} \mu(i)$
å¯ä»¥çŸ¥é“å…ˆç®—$\mu(n)$å¦‚æœç­‰äº0å°±ç›´æ¥æ˜¯0äº†
ç°åœ¨æ˜¾ç„¶nä¸ºkä¸ªä¸åŒè´¨æ•°çš„ä¹˜ç§¯
$$=\mu(n)\cdot \sum\limits_{i=1}^m \mu(i)[(i,n)=1] \\
=\mu(n)\cdot \sum\limits_{i=1}^m \mu(i) \sum\limits_{d \mid (i,n)}\mu(d) \\
=\mu(n)\cdot \sum\limits_{d\mid n} \mu(d)\sum\limits_{e=1}^{ \lfloor \frac md \rfloor } \mu(e\cdot d)\\
$$
$$f( m/d, d ) = \sum\limits_{e=1}^{ \lfloor \frac md \rfloor } \mu(e\cdot d)$$
$$ \Rightarrow  f(m,n ) = \mu(n)\cdot \sum\limits_{d\mid n} \mu(d) \cdot  f(m/d, d)$$

è¿™ä¸ªå¼å­å¯ä»¥é€’å½’è®¡ç®—ï¼Œè¾¹ç•Œä¸ºï¼š

m=0:0

m=1:u(n);

n=1:segma{u(i)|1<=i<=m}

å…¶ä¸­segma{u(i)|1<=i<=m}å¯ä»¥ç”¨æœæ•™ç­›åœ¨O(m^(2/3))å†…æ±‚å‡º

æ±‚è§£è¿‡ç¨‹ä¸­è¦æ±‚çš„u(i)éƒ½å¯ä»¥O(1)æ±‚å‡ºï¼Œåšæ³•æ˜¯å…ˆå°†nå”¯ä¸€åˆ†è§£ï¼Œç„¶åæšä¸¾å­é›†ï¼Œåˆ¤ä¸€ä¸‹å…ƒç´ ä¸ªæ•°ï¼Œä¿å­˜ä¸‹æ¥ä»¥åå°±å¯ä»¥O(1)æ±‚äº†

è¦é¢„å…ˆå¤„ç†å‡ºæ‰€æœ‰è´¨æ•°å› å­ä¹˜ç§¯ï¼Œç„¶åäºŒè¿›åˆ¶æŸ¥å­é›†é€’å½’è®¡ç®—ã€‚ã€‚
ç¬¬ä¸€å±‚æœ€å¤šæœ‰2^11ä¸ªçŠ¶æ€ï¼Œç¬¬äºŒå±‚ m/p æœ€å¤šé™¤9æ¬¡ï¼ˆp=2ï¼‰æ—¶ï¼Œå› å­è¶Šå¤šåˆ†æ”¯å˜å¤šä½†æ˜¯å±‚æ•°è¶Šå°‘ã€‚mæœ€å¤šæœ‰2*3*5*7ä¸ªå› å­ã€‚ã€‚

å¦å¤–ä¸€ç§è§£æ³•ï¼špå–mçš„æœ€å°è´¨å› å­
https://blog.csdn.net/qkoqhh/article/details/82594734
$$
=\sum_{i=1}^m \mu(i\cdot \frac np \cdot p) \\
=\sum_{(i,p)=1}^{i\leq m} \mu(i\cdot \frac np ) \cdot \mu(p)  \\
=- \sum_{(i,p)=1}^{i\leq m} \mu(i\cdot \frac np)  \\
=-\sum_{i=1}^{m} \mu(i\cdot \frac np) + \sum_{(i,p)>1}^{i\leq m} \mu(i\cdot \frac np) \\
=-f (m, \frac np ) +\sum_{p\mid i}^{i\leq m} \mu(n\cdot \frac ip)\\
=-f (m, \frac np ) +\sum_{e=1}^{e\leq \lfloor \frac mp \rfloor } \mu(n\cdot e)\\
=-f (m, \frac np ) +f( \lfloor \frac mp \rfloor, n  )\\
$$





---

za> æ¥è‡ªKeyIDæ•°è®ºzaå‡½æ•°ppt

---

> 2015 ICPC é•¿æ˜¥ B
- å®šä¹‰f(n)=é€‰ä¸¤ä¸ª[0,n)çš„æ•´æ•°a,bï¼Œä¸”abä¸æ˜¯nçš„å€æ•°çš„æ–¹æ¡ˆæ•°ã€‚
- æ±‚$g(n)=\sum_{d \mid n}f(d)$
- 1 â‰¤ ğ‘‡ â‰¤ 20000ï¼Œ1 â‰¤ ğ‘› â‰¤ 10^9

ä¸¤ä¸ª[0,n)çš„æ•´æ•°a,bï¼Œä¸”abæ˜¯nçš„å€æ•°çš„æ–¹æ¡ˆæ•°:
$$\sum_{a=0}^{n-1}\sum_{b=0}^{n-1}[n\mid ab] \\
(a,n)=d, n\mid ab \\ 
\rightarrow \frac nd\mid \frac ad\cdot b , (\frac nd, \frac ad) = 1 \rightarrow \frac nd \mid  b  \\
=\sum_{d \mid n}\sum_{(a,n)=d}\sum_{\frac nd \mid b} 1 \\ 
=\sum_{d \mid n}\sum_{(a,n)=d} (\frac{n}{\frac nd}) \\
=\sum_{d \mid n}\sum_{(\frac ad, \frac nd)=1} d \\
=\sum_{d \mid n}\phi(\frac nd) \cdot d \\
$$

å› æ­¤
$$f(n) = n^2 - \sum_{d \mid n}\phi(\frac nd) \cdot d$$
ä»¤
$$h(n) =  \sum_{d \mid n}\phi(\frac nd) \cdot d$$
$$g(n) = \sum_{d \mid n} d^2 - \sum_{d \mid n} h(d) $$
è®¾
$$
P(n) = \sum_{d \mid n} d^2\\
Q(n) = \sum_{d \mid n} h(d)\\
$$
å› ä¸ºè¿™äº›éƒ½æ˜¯ç§¯æ€§å‡½æ•°
æ ¹æ®ç§¯æ€§å‡½æ•°çš„æ€§è´¨ï¼Œæˆ‘ä»¬åªéœ€è¦è®¡ç®—$ğ‘ƒ(ğ‘^ğ‘˜)$å’Œ$ğ‘„(ğ‘^ğ‘˜)$ï¼Œä¹˜èµ·æ¥å°± å¯ä»¥å¾—åˆ°ğ‘ƒ (ğ‘›) å’Œğ‘„(ğ‘›)ã€‚è€Œè¿™æ˜¯å¾ˆå®¹æ˜“è®¡ç®—çš„ï¼Œå› ä¸º$ğ‘^ğ‘˜$çš„å› æ•°åª æœ‰$ğ‘^0, ğ‘^1, â‹¯ , ğ‘^ğ‘˜$ã€‚

- è§£æ³•2

$$\sum_{d \mid n}\phi(\frac nd) = n \\
Q(n) = \sum_{d \mid n}h(d) = \sum_{d \mid n}\sum_{e \mid d}\phi(e) \cdot \frac de = \nu * \phi * id = (\nu * \phi ) * id = id * id \\
= \sum_{d\mid n}d*\frac nd=n \cdot \tau(n)
$$


å†™çš„å¥½éº»çƒ¦ï¼Œæˆ‘è¿˜æ˜¯æ‰‹ç®—ç„¶åçœ‹ä¸€éã€‚äº†è§£äº†ä¸€äº›åŸºç¡€æ•°è®ºçŸ¥è¯†åå›å¤´å†çœ‹pdfè®²çš„å¾ˆæ¸…æ¥šäº†wwwwæ¯”ä¸€äº›åšå®¢é‡Œéƒ½è¦æ¸…æ¥šã€‚é‡Œé¢çš„ä¸€äº›é¢˜å°±ç›´æ¥æ”¾ä»£ç å§ã€‚
